<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Windows Subsystem for Linux Dot files | Parsecs Reach</title>
<meta name="keywords" content="Windows Subsystem for Linux, wsl, dotfiles">
<meta name="description" content="I&rsquo;ve been using the Windows Subsystem for Linux (WSL) for a while at work. It&rsquo;s been something of a radical improvement over cygwin for most of my use cases. A couple of weeks ago my installation got borked by the work Antivirus (AV) system. So I&rsquo;ve created an automated script to set up my environment just how I currently like it.
Before we start lets get one thing out the way.">
<meta name="author" content="Emily Selwood">
<link rel="canonical" href="https://parsecsreach.org/post/wsl_dot_files/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.979d31a757b649bf90615e658aedd46e2896dc33bf05775ea99697ce5b3e4fe4.css" integrity="sha256-l50xp1e2Sb&#43;QYV5liu3UbiiW3DO/BXdeqZaXzls&#43;T&#43;Q=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://parsecsreach.org/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://parsecsreach.org/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://parsecsreach.org/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://parsecsreach.org/apple-touch-icon.png">
<link rel="mask-icon" href="https://parsecsreach.org/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="Windows Subsystem for Linux Dot files" />
<meta property="og:description" content="I&rsquo;ve been using the Windows Subsystem for Linux (WSL) for a while at work. It&rsquo;s been something of a radical improvement over cygwin for most of my use cases. A couple of weeks ago my installation got borked by the work Antivirus (AV) system. So I&rsquo;ve created an automated script to set up my environment just how I currently like it.
Before we start lets get one thing out the way." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://parsecsreach.org/post/wsl_dot_files/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2018-08-09T08:25:13+01:00" />
<meta property="article:modified_time" content="2018-08-09T08:25:13+01:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Windows Subsystem for Linux Dot files"/>
<meta name="twitter:description" content="I&rsquo;ve been using the Windows Subsystem for Linux (WSL) for a while at work. It&rsquo;s been something of a radical improvement over cygwin for most of my use cases. A couple of weeks ago my installation got borked by the work Antivirus (AV) system. So I&rsquo;ve created an automated script to set up my environment just how I currently like it.
Before we start lets get one thing out the way."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Posts",
      "item": "https://parsecsreach.org/post/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "Windows Subsystem for Linux Dot files",
      "item": "https://parsecsreach.org/post/wsl_dot_files/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Windows Subsystem for Linux Dot files",
  "name": "Windows Subsystem for Linux Dot files",
  "description": "I\u0026rsquo;ve been using the Windows Subsystem for Linux (WSL) for a while at work. It\u0026rsquo;s been something of a radical improvement over cygwin for most of my use cases. A couple of weeks ago my installation got borked by the work Antivirus (AV) system. So I\u0026rsquo;ve created an automated script to set up my environment just how I currently like it.\nBefore we start lets get one thing out the way.",
  "keywords": [
    "Windows Subsystem for Linux", "wsl", "dotfiles"
  ],
  "articleBody": "I’ve been using the Windows Subsystem for Linux (WSL) for a while at work. It’s been something of a radical improvement over cygwin for most of my use cases. A couple of weeks ago my installation got borked by the work Antivirus (AV) system. So I’ve created an automated script to set up my environment just how I currently like it.\nBefore we start lets get one thing out the way. Windows is a perfectly fine development environment. I won’t be tolerating any comments of just use a mac or just install linux. This is not always possible with a corporate machine. If this is of no help to you stop reading and go look at something else.\nAssumptions You have Ubuntu for windows already installed but not yet configured\nProcess Step one was to create a directory to keep my initial environment in. Later we will turn it into a git repo as this sort of thing should not be kept on your machine. The times you need it most are when your machine has died and you need to build a new one.\nmkdir -p /mnt/c/git/dotfiles/bin cd /mnt/c/git/dotfiles Next is to create the skeleton of the script that will do all the work for us in future. In the bin folder create a script called setup.sh\n#!/bin/sh # This needs to be run with sudo apt update apt upgrade -y This updates all the existing packages.\nNext we need to install the new things that we want. Add the following underneath:\napt install -y $(cat ../pkglist.txt) This installs everything listed in a file one level up called pkglist.txt lets go and create that now. The following is mine:\nbuild-essential git ssh vim tmux make wget curl zip python3 python3-pip xdg-utils dos2unix jq html-xml-utils Next we will create a directory in our home folder called bin to house all the executable things we need for our user:\nmkdir -p ~/bin chown wselwood: ~/bin We need to change the owner of the bin folder as we are currently running as root\nNow my work environment is very mixed. I work in a mixture of almost even parts Scala/Java, Go, and Python. I install python 3 the pkglist.txt already so that is easy enough. Next we will tackle java\nJava There are plenty of guides about installing java on a ubuntu system out there. Digital Ocean have a good one that I usually follow. It boils down to adding a line to the setup.sh file and one entry in the pgklist.txt\nThe setup.sh should now look like this\n#!/bin/sh # This needs to be run with sudo add-apt-repository ppa:webupd8team/java apt update apt upgrade -y apt install -y $(cat ../pkglist.txt) Then add oracle-java8-installer to the pgklist.txt file.\nAlmost done. One last little trick to make our Java life easier. If we sym-link our WSL ~/.m2 folder to our windows .m2 folder we can avoid having two sets of libraries and very strange problems if we do mvn install at any point. Add the following to the bottom of your setup.sh\nln -s /mnt/c/Users/Wil.Selwood/.m2/ ~/.m2/ Next on to go\nGo Unfortunately at the time of writing the version of Go in the ubuntu package manager is way out of date so we need to go and get the latest version our selves. For this we are going to use a few tricks to make sure we always download the latest version.\nFirst off installing go its self. Unfortunately there isn’t a handy URL I could find that always points to the latest stable build. There is a link on the download page but it changes with each version. So we are going to use the html-xml-utils package of tools to do some nasty (but better than pure regex) command line foo to get hold of the url from that page. Using chrome inspect the download link we are after. It should have a class of downloadBox So we can use that to find the one we need\nGet hold of the page. We will use curl (cat url from my understanding) pass it a URL and it returns the text content to stdout. Normalise the html into valid XML Extract the links with a class of downloadBox Find the link that says its for linux-amd64 Extract the link from that line. The following line does this and stores the resulting text in a variable for us to download later:\ngo_url=$(curl --silent \"https://golang.org/dl/\" | hxnormalize -x | hxselect -s '\\n' -i 'a.downloadBox' | grep linux-amd64 | grep -Po 'http[^\\\"]+') Thats a bit long and unpleasant but it does the job. Now that we have the download url we can download, extract, and link to our path\nwget $go_url -O ~/go-linux.tar.gz tar xzf ~/go-linux.tar.gz -C ~/ ln -s ~/go/bin/go ~/bin/go ln -s ~/go/bin/godoc ~/bin/godoc ln -s ~/go/bin/gofmt ~/bin/gofmt That should get us go installed. I’ve a few projects that use dep for package management so we need to install that too. This is a little bit easier as dep has its releases in github which provides an api to download them so we can use the jq command line tool to extract the url we need from the json response.\nSend the query to the github API Extract the asset that has a name ending with linux-amd64 and pull out the browser_download_url dep_url=$(curl --silent \"https://api.github.com/repos/golang/dep/releases/latest\" | jq -r '.assets[] | select(.name | endswith(\"linux-amd64\")).browser_download_url') Now we just need to download that url and make it executable\nwget $dep_url -O ~/bin/dep chmod +x ~/bin/dep There we go. That should be go set up and ready to work.\nNow on to some quality of life changes\nQuality of life vim and git default configuration I have a copy of my .vimrc and .gitconfig files stored in the dotfiles directory so we need to copy those over to our home directory. The following mess of characters copies everything from the directory above that starts with a dot to our home directory. Note there is no -r flag on the cp command so it will not copy the .git folder that exists in our project.\ncp ../.* ~/ My configuration for vim and git are not too complex. I am colour blind and find the default colour schemes of both programs hard to read. So I change them in this config.\nbash I use mrzool’s Sensible bash as a starting point here. Along with a .bashrc file that I have had for so long I’m not sure where it came from.\nDrop the sensible.bash file into the bin directory and the entry to source it to your .bashrc file. There are instructions in the git repo.\nI also add an entry to make ~/bin and ~/.local/bin be part of the path.\nNext I like to enable xdg-open to start a web browser. I find this really useful to include at the end of long build processes to open a browser to the server I have just launched so that I get pulled back from what ever I went off to do while the build ran.\nThe first step is to create a sym-link that points to your windows browser executable. Chrome in my case.\nln -s /mnt/c/Program\\ Files\\ \\(x86\\)/Google/Chrome/Application/chrome.exe /usr/bin/chrome Then in your .bashrc file add export BROSWER=chrome and you should now be able to type xdg-open https://google.com and it will pop open a new chrome tab for you.\nThe last thing I have added to my .bashrc file is a thing that starts my ssh agent the first time I open a shell. This actually works way better under WSL than it did under cygwin as it lasts until you logout rather than as long as a single shell is left open. You may not want to do this depending on how paranoid you are about security. However it does mean that I don’t have to type in my ssh key password several hundred times a day.\nexport SSH_AUTH_SOCK=$HOME/.ssh-socket ssh-add -l ? /dev/null 2\u003e\u00261 if [ $? = 2 ]; then rm -rf $SSH_AUTH_SOCK ssh-agent -a $SSH_AUTH_SOCK \u003e| /tmp/.ssh-script source /tmp/.ssh-script echo $SSH_AGENT_PID \u003e| ~/.ssh-agent-pid rm /tmp/.ssh-script ssh-add fi And there we will leave the changes. Now all that we need to do is commit this to a remote repo somewhere. You can find mine on github There are a few tweaks in there I don’t mention here as they are only todo with the way I my disk is layed out.\nI hope you have found this useful and have some ideas for your own environment. If you have any questions or comments please let me know on twitter I’d love to see your suggestions and little things you have found that makes your life a bit easier.\n",
  "wordCount" : "1450",
  "inLanguage": "en",
  "datePublished": "2018-08-09T08:25:13+01:00",
  "dateModified": "2018-08-09T08:25:13+01:00",
  "author":{
    "@type": "Person",
    "name": "Emily Selwood"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://parsecsreach.org/post/wsl_dot_files/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Parsecs Reach",
    "logo": {
      "@type": "ImageObject",
      "url": "https://parsecsreach.org/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://parsecsreach.org" accesskey="h" title="Parsecs Reach (Alt + H)">Parsecs Reach</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a rel="" href="https://parsecsreach.org/orbviewer"  target="_blank" title="Orb Viewer">
                    <span>Orb Viewer</span>
                    
                </a>
            </li>
            <li>
                <a rel="me" href="https://mastodon.me.uk/@emily_s"  target="_blank" title="">
                    <span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 417.8 512" class="logo-social" width="18" height="18"><path d="M417.8 179.1c0-97.2-63.7-125.7-63.7-125.7-62.5-28.7-228.5-28.4-290.4 0 0 0-63.7 28.5-63.7 125.7 0 115.7-6.6 259.4 105.6 289.1 40.5 10.7 75.3 13 103.3 11.4 50.8-2.8 79.3-18.1 79.3-18.1l-1.7-36.9s-36.3 11.4-77.1 10.1c-40.4-1.4-83-4.4-89.6-54-.6-4.4-.9-9-.9-13.9 85.6 20.9 158.6 9.1 178.7 6.7 56.1-6.7 105-41.3 111.2-72.9 9.8-49.8 9-121.5 9-121.5zm-75.1 125.2h-46.6V190.1c0-49.7-64-51.6-64 6.9v62.5h-46.3V197c0-58.5-64-56.6-64-6.9v114.2H75.1c0-122.1-5.2-147.9 18.4-175 25.9-28.9 79.8-30.8 103.8 6.1l11.6 19.5 11.6-19.5c24.1-37.1 78.1-34.8 103.8-6.1 23.7 27.3 18.4 53 18.4 175z"/></svg></span>
                    
                </a>
            </li>
            <li>
                <a rel="" href="https://github.com/emilyselwood"  target="_blank" title="">
                    <span><svg width="18" height="18" class="logo-social" stroke="none" viewBox="0 0 11.493062 11.209467" xmlns="http://www.w3.org/2000/svg"><path d="M 5.746044,0 C 2.572808,0 0,2.572808 0,5.74675 c 0,2.538941 1.646414,4.69265 3.929944,5.452886 0.287514,0.05256 0.392289,-0.124883 0.392289,-0.277283 0,-0.136173 -0.0049,-0.49777 -0.0078,-0.977195 C 2.715997,10.292291 2.378741,9.174691 2.378741,9.174691 2.117333,8.511116 1.740566,8.334375 1.740566,8.334375 1.218808,7.977716 1.780076,7.984772 1.780076,7.984772 2.356868,8.025692 2.660257,8.577086 2.660257,8.577086 3.172843,9.45515 4.005398,9.201503 4.332776,9.054747 4.384986,8.683272 4.533154,8.429978 4.697548,8.286397 3.421551,8.141405 2.079937,7.648222 2.079937,5.446183 c 0,-0.627239 0.224014,-1.140178 0.591609,-1.541991 -0.05927,-0.145345 -0.25647,-0.729545 0.05609,-1.520825 0,0 0.4826,-0.154517 1.580445,0.589138 C 4.766339,2.845153 5.258111,2.7813 5.746709,2.779183 6.2346,2.781283 6.726372,2.845153 7.185336,2.972505 8.282475,2.22885 8.764017,2.383367 8.764017,2.383367 c 0.313619,0.79128 0.116416,1.37548 0.05715,1.520825 0.3683,0.401813 0.590903,0.914752 0.590903,1.541991 0,2.207683 -1.343731,2.693458 -2.623961,2.835628 0.206375,0.177447 0.390172,0.528108 0.390172,1.06433 0,0.767998 -0.0071,1.387828 -0.0071,1.576212 0,0.153811 0.103364,0.332669 0.395111,0.276577 2.281767,-0.761647 3.92677,-2.913944 3.92677,-5.45218 C 11.493062,2.572808 8.919901,0 5.745959,0"/></svg></span>
                    
                </a>
            </li>
            <li>
                <a rel="" href="https://parsecsreach.org/about"  target="_self" title="About me">
                    <span>About me</span>
                    
                </a>
            </li>
            <li>
                <a rel="" href="https://parsecsreach.org/"  target="_self" title="Home">
                    <span>Home</span>
                    
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      Windows Subsystem for Linux Dot files
    </h1>
    <div class="post-meta"><span title='2018-08-09 08:25:13 +0100 BST'>2018 August 9</span>&nbsp;·&nbsp;Emily Selwood

</div>
  </header> 
  <div class="post-content"><p>I&rsquo;ve been using the Windows Subsystem for Linux (WSL) for a while at work. It&rsquo;s been something of a radical improvement over cygwin for most of my use cases. A couple of weeks ago my installation got borked by the work Antivirus (AV) system. So I&rsquo;ve created an automated script to set up my environment just how I currently like it.</p>
<p>Before we start lets get one thing out the way. Windows is a perfectly fine development environment. I won&rsquo;t be tolerating any comments of just use a mac or just install linux. This is not always possible with a corporate machine. If this is of no help to you stop reading and go look at something else.</p>
<h1 id="assumptions">Assumptions<a hidden class="anchor" aria-hidden="true" href="#assumptions">#</a></h1>
<p>You have Ubuntu for windows already installed but not yet configured</p>
<h1 id="process">Process<a hidden class="anchor" aria-hidden="true" href="#process">#</a></h1>
<p>Step one was to create a directory to keep my initial environment in. Later we will turn it into a git repo as this sort of thing should not be kept on your machine. The times you need it most are when your machine has died and you need to build a new one.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mkdir -p /mnt/c/git/dotfiles/bin
</span></span><span style="display:flex;"><span>cd /mnt/c/git/dotfiles
</span></span></code></pre></div><p>Next is to create the skeleton of the script that will do all the work for us in future. In the bin folder create a script called <code>setup.sh</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/sh
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># This needs to be run with sudo</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>apt update
</span></span><span style="display:flex;"><span>apt upgrade -y
</span></span></code></pre></div><p>This updates all the existing packages.</p>
<p>Next we need to install the new things that we want. Add the following underneath:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>apt install -y <span style="color:#66d9ef">$(</span>cat ../pkglist.txt<span style="color:#66d9ef">)</span>
</span></span></code></pre></div><p>This installs everything listed in a file one level up called <code>pkglist.txt</code> lets go and create that now. The following is mine:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>build-essential
</span></span><span style="display:flex;"><span>git
</span></span><span style="display:flex;"><span>ssh
</span></span><span style="display:flex;"><span>vim
</span></span><span style="display:flex;"><span>tmux
</span></span><span style="display:flex;"><span>make
</span></span><span style="display:flex;"><span>wget
</span></span><span style="display:flex;"><span>curl
</span></span><span style="display:flex;"><span>zip
</span></span><span style="display:flex;"><span>python3
</span></span><span style="display:flex;"><span>python3-pip
</span></span><span style="display:flex;"><span>xdg-utils
</span></span><span style="display:flex;"><span>dos2unix
</span></span><span style="display:flex;"><span>jq
</span></span><span style="display:flex;"><span>html-xml-utils
</span></span></code></pre></div><p>Next we will create a directory in our home folder called bin to house all the executable things we need for our user:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mkdir -p ~/bin
</span></span><span style="display:flex;"><span>chown wselwood: ~/bin
</span></span></code></pre></div><p>We need to change the owner of the bin folder as we are currently running as root</p>
<p>Now my work environment is very mixed. I work in a mixture of almost even parts Scala/Java, Go, and Python. I install python 3 the pkglist.txt already so that is easy enough. Next we will tackle java</p>
<h2 id="java">Java<a hidden class="anchor" aria-hidden="true" href="#java">#</a></h2>
<p>There are plenty of guides about installing java on a ubuntu system out there. <a href="https://www.digitalocean.com/community/tutorials/how-to-install-java-with-apt-get-on-ubuntu-16-04">Digital Ocean</a> have a good one that I usually follow. It boils down to adding a line to the <code>setup.sh</code> file and one entry in the <code>pgklist.txt</code></p>
<p>The <code>setup.sh</code> should now look like this</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/sh
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># This needs to be run with sudo</span>
</span></span><span style="display:flex;"><span>add-apt-repository ppa:webupd8team/java
</span></span><span style="display:flex;"><span>apt update
</span></span><span style="display:flex;"><span>apt upgrade -y
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>apt install -y <span style="color:#66d9ef">$(</span>cat ../pkglist.txt<span style="color:#66d9ef">)</span>
</span></span></code></pre></div><p>Then add <code>oracle-java8-installer</code> to the <code>pgklist.txt</code> file.</p>
<p>Almost done. One last little trick to make our Java life easier. If we sym-link our WSL <code>~/.m2</code> folder to our windows <code>.m2</code> folder we can avoid having two sets of libraries and very strange problems if we do <code>mvn install</code> at any point. Add the following to the bottom of your <code>setup.sh</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ln -s /mnt/c/Users/Wil.Selwood/.m2/ ~/.m2/
</span></span></code></pre></div><p>Next on to go</p>
<h2 id="go">Go<a hidden class="anchor" aria-hidden="true" href="#go">#</a></h2>
<p>Unfortunately at the time of writing the version of Go in the ubuntu package manager is way out of date so we need to go and get the latest version our selves. For this we are going to use a few tricks to make sure we always download the latest version.</p>
<p>First off installing go its self. Unfortunately there isn&rsquo;t a handy URL I could find that always points to the latest stable build. There is a link on the <a href="https://golang.org/dl">download</a> page but it changes with each version. So we are going to use the <code>html-xml-utils</code> package of tools to do some nasty (but better than pure regex) command line foo to get hold of the url from that page. Using chrome inspect the download link we are after. It should have a class of <code>downloadBox</code> So we can use that to find the one we need</p>
<ol>
<li>Get hold of the page. We will use curl (cat url from my understanding) pass it a URL and it returns the text content to stdout.</li>
<li>Normalise the html into valid XML</li>
<li>Extract the links with a class of downloadBox</li>
<li>Find the link that says its for linux-amd64</li>
<li>Extract the link from that line.</li>
</ol>
<p>The following line does this and stores the resulting text in a variable for us to download later:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>go_url<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>curl --silent <span style="color:#e6db74">&#34;https://golang.org/dl/&#34;</span> | hxnormalize -x | hxselect -s <span style="color:#e6db74">&#39;\n&#39;</span> -i <span style="color:#e6db74">&#39;a.downloadBox&#39;</span> | grep linux-amd64 | grep -Po <span style="color:#e6db74">&#39;http[^\&#34;]+&#39;</span><span style="color:#66d9ef">)</span>
</span></span></code></pre></div><p>Thats a bit long and unpleasant but it does the job. Now that we have the download url we can download, extract, and link to our path</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>wget $go_url -O ~/go-linux.tar.gz
</span></span><span style="display:flex;"><span>tar xzf ~/go-linux.tar.gz -C ~/
</span></span><span style="display:flex;"><span>ln -s ~/go/bin/go ~/bin/go
</span></span><span style="display:flex;"><span>ln -s ~/go/bin/godoc ~/bin/godoc
</span></span><span style="display:flex;"><span>ln -s ~/go/bin/gofmt ~/bin/gofmt
</span></span></code></pre></div><p>That should get us go installed. I&rsquo;ve a few projects that use dep for package management so we need to install that too. This is a little bit easier as dep has its releases in github which provides an api to download them so we can use the <code>jq</code> command line tool to extract the url we need from the json response.</p>
<ol>
<li>Send the query to the github API</li>
<li>Extract the asset that has a name ending with linux-amd64 and pull out the browser_download_url</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>dep_url<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>curl --silent <span style="color:#e6db74">&#34;https://api.github.com/repos/golang/dep/releases/latest&#34;</span> | jq -r <span style="color:#e6db74">&#39;.assets[] | select(.name | endswith(&#34;linux-amd64&#34;)).browser_download_url&#39;</span><span style="color:#66d9ef">)</span>
</span></span></code></pre></div><p>Now we just need to download that url and make it executable</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>wget $dep_url -O ~/bin/dep
</span></span><span style="display:flex;"><span>chmod +x ~/bin/dep
</span></span></code></pre></div><p>There we go. That should be go set up and ready to work.</p>
<p>Now on to some quality of life changes</p>
<h1 id="quality-of-life">Quality of life<a hidden class="anchor" aria-hidden="true" href="#quality-of-life">#</a></h1>
<h2 id="vim-and-git-default-configuration">vim and git default configuration<a hidden class="anchor" aria-hidden="true" href="#vim-and-git-default-configuration">#</a></h2>
<p>I have a copy of my <code>.vimrc</code> and <code>.gitconfig</code> files stored in the dotfiles directory so we need to copy those over to our home directory. The following mess of characters copies everything from the directory above that starts with a dot to our home directory. Note there is no -r flag on the cp command so it will not copy the .git folder that exists in our project.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cp ../.* ~/
</span></span></code></pre></div><p>My configuration for vim and git are not too complex. I am colour blind and find the default colour schemes of both programs hard to read. So I change them in this config.</p>
<h2 id="bash">bash<a hidden class="anchor" aria-hidden="true" href="#bash">#</a></h2>
<p>I use <a href="https://github.com/mrzool/bash-sensible">mrzool&rsquo;s Sensible bash</a> as a starting point here. Along with a <code>.bashrc</code> file that I have had for so long I&rsquo;m not sure where it came from.</p>
<p>Drop the <code>sensible.bash</code> file into the bin directory and the entry to source it to your <code>.bashrc</code> file. There are instructions in the git repo.</p>
<p>I also add an entry to make <code>~/bin</code> and <code>~/.local/bin</code> be part of the path.</p>
<p>Next I like to enable <code>xdg-open</code> to start a web browser. I find this really useful to include at the end of long build processes to open a browser to the server I have just launched so that I get pulled back from what ever I went off to do while the build ran.</p>
<p>The first step is to create a sym-link that points to your windows browser executable. Chrome in my case.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ln -s /mnt/c/Program<span style="color:#ae81ff">\ </span>Files<span style="color:#ae81ff">\ \(</span>x86<span style="color:#ae81ff">\)</span>/Google/Chrome/Application/chrome.exe /usr/bin/chrome
</span></span></code></pre></div><p>Then in your <code>.bashrc</code> file add <code>export BROSWER=chrome</code> and you should now be able to type <code>xdg-open https://google.com</code> and it will pop open a new chrome tab for you.</p>
<p>The last thing I have added to my <code>.bashrc</code> file is a thing that starts my ssh agent the first time I open a shell. This actually works way better under WSL than it did under cygwin as it lasts until you logout rather than as long as a single shell is left open. You may not want to do this depending on how paranoid you are about security. However it does mean that I don&rsquo;t have to type in my ssh key password several hundred times a day.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>export SSH_AUTH_SOCK<span style="color:#f92672">=</span>$HOME/.ssh-socket
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ssh-add -l ? /dev/null 2&gt;&amp;<span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> $? <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>  rm -rf $SSH_AUTH_SOCK
</span></span><span style="display:flex;"><span>  ssh-agent -a $SSH_AUTH_SOCK &gt;| /tmp/.ssh-script
</span></span><span style="display:flex;"><span>  source /tmp/.ssh-script
</span></span><span style="display:flex;"><span>  echo $SSH_AGENT_PID &gt;| ~/.ssh-agent-pid
</span></span><span style="display:flex;"><span>  rm /tmp/.ssh-script
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  ssh-add
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span></code></pre></div><p>And there we will leave the changes. Now all that we need to do is commit this to a remote repo somewhere. You can find mine on <a href="https://github.com/wselwood/dotfiles">github</a> There are a few tweaks in there I don&rsquo;t mention here as they are only todo with the way I my disk is layed out.</p>
<p>I hope you have found this useful and have some ideas for your own environment. If you have any questions or comments please let me know on <a href="https://twitter.com/wilselwood">twitter</a> I&rsquo;d love to see your suggestions and little things you have found that makes your life a bit easier.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://parsecsreach.org/tags/windows-subsystem-for-linux/">Windows Subsystem for Linux</a></li>
      <li><a href="https://parsecsreach.org/tags/wsl/">wsl</a></li>
      <li><a href="https://parsecsreach.org/tags/dotfiles/">dotfiles</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://parsecsreach.org/post/golangresparse/">
    <span class="title">« Prev</span>
    <br>
    <span>Golang Resparse</span>
  </a>
  <a class="next" href="https://parsecsreach.org/post/flatroofs_with_qgis/">
    <span class="title">Next »</span>
    <br>
    <span>Finding flatroofs with QGIS</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>All rights reserved - 2022</span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
